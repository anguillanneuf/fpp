legend=c("Mean method","Naive method","Drift method"))
lines(dj)
dj3 <- window(dj, start=251)
accuracy(meanf(dj2,h=42), dj3)
accuracy(rwf(dj2,h=42), dj3)
accuracy(rwf(dj2,drift=TRUE,h=42), dj3)
dj2 <- window(dj, end=250)
plot(dj2, main="Dow Jones Index (daily ending 15 Jul 94)",
ylab="", xlab="Day")
res <- residuals(naive(dj2))
plot(res, main="Residuals from naive method",
ylab="", xlab="Day")
Acf(res, main="ACF of residuals")
?Acf
hist(res, nclass="FD", main="Histogram of residuals")
?hist
hist(res, main="Histogram of residuals")
"FD"
q()
y()
q()
rm(list=ls())
require("fma")
require("ffp")
require("fpp")
library(fpp); library(fma)
setwd("./fpp")
rep(.2, 5)
a <- c(rep(.2, 5), 0, 0)
b <- c(0, rep(.2, 5), 0)
c <- c(0, 0, rep(.2, 5))
(a+b+c)*1/3
round((a+b+c)*1/3,3)
rm(list=ls())
rm(list=ls())
?plastics
plot(plastics)
seasonplot(plastics)
plot(stl(plastics,"periodic"))
plot(plastics, ylab="Quantity", xlab="Year",
main="Monthly sales of product A")
fit <- decompose(platics, type = "multiplicative")
fit <- decompose(plastics, type = "multiplicative")
plot(fit)
fit
fit$seasonal
fit$trend
plot(fit$trend)
plot(fit$seasonal)
plot(seasadj(fit))
plot(seasadj(fit))
seasadj(fit)
plastics
plastics2 <- plastics
plot(plastics2)
plastics2[30]
plastics2[30] <- plastics[30]+500
plot(plastics2)
fit2 <- decompose(plastics2, type = "multiplicative")
plot(seasadj(fit2))
plastics3 <- plastics
plastics3[3] <- plastics[3]+500
fit3 <- decompose(plastics3, type = "multiplicative")
plot(seasadj(fit3))
plastics4 <- plastics
plastics4[55] <- plastics[55]+500
fit4 <- decompose(plastics4, type = "multiplicative")
plot(seasadj(fit4))
rm(list=ls())
fit <- decompose(plastics, type = "multiplicative")
s <- seasadj(fit)
plot(s)
?rwf
rwf(s, h=10, drift = TRUE)
fit.final <- rwf(s, h=10, drift = TRUE)
plot(fit.final)
fit.final$mean
fit.final$mean*fit$seasonal
fit.final$mean
fit$seasonal
fit.final$mean*fit$seasonal[1]
plot(plastics)
forecast0 <- fit.final$mean * fit$seasonal[1]
lines(forecast0, col=4)
plot(plastics, xlim=1:7)
plot(plastics, xlim=c(1:7))
plot(plastics, xlim=c(1:70))
plastics
plot(plastics, xlim=c(1:6))
plot(plastics, xlim=c(1,6))
plot(plastics, xlim=c(1,7))
forecast0 <- fit.final$mean * fit$seasonal[1]
lines(forecast0, col=4)
fit$seasonal[1]
fit$seasonal[1,]
fit$seasonal
fit$seasonal[1:12]
forecast0 <- fit.final$mean * fit$seasonal[1:12]
fit.final$mean
forecast0 <- fit.final$mean * fit$seasonal[1:10]
lines(forecast0, col=4)
rm(list=ls())
fit <- decompose(plastics, type = "multiplicative")
s <- seasadj(fit)
plot(s)
fit.final <- rwf(s, h=12, drift = TRUE)
plot(fit.final)
plot(plastics, xlim=c(1,7))
forecast0 <- fit.final$mean * fit$seasonal[1:10]
forecast0 <- fit.final$mean * fit$seasonal[1:12]
lines(forecast0, col=4)
fit2 <- stl(plastics, s.window = "periodic", robust = TRUE)
plot(fit2)
eeadj <- seasadj(fit2)
plot(eeadj)
fit2.final <- rwf(eeadj, h=12, drift=TRUE)
plot(fit2.final)
plot(plastics, xlim=c(1,7))
fit2
fit2 <- stl(plastics, s.window = "periodic", robust = TRUE)
fit2
fit2$seasonnal
fit2$seasonal
fit2 <- stl(plastics, s.window = "periodic", robust = TRUE)
eeadj <- seasadj(fit2)
plot(eeadj)
plastics
plot(plastics)
plot(plastics, xlim=c(1,7))
fit.final
x <- fit.final$mean * fit$seasonal[1:12]
lines(x, col=4)
plot(x, col=4)
fit2 <- stl(plastics, s.window = "periodic", robust = TRUE)
eeadj <- seasadj(fit2)
plot(eeadj)
fit2.final <- rwf(eeadj, h=12, drift=TRUE)
plot(fit2.final)
plot(plastics, xlim=c(1,7))
fit2
fit2$seasonal
fit2[,2]
fit2$weights
fit2$deg
fit2$call
fit2$win
fit2$deg
fit2$jump
fit2$inner
fit2$outer
seasonal(fit2)
str(fit2)
fit2$time.series
fit2$time.series$seasonal
fit2$time.series[1,]
fit2$time.series[,1]
fit2$time.series[,1][1,]
fit2$time.series[,1][1]
fit2$time.series[,1][1:12]
forecast1 <- fit2.final$mean * fit2$time.series[,1][1:12]
lines(forecast1, col=4)
fit2.final$mean
fit2$time.series[,1][1:12]
plot(BoxCox(plastics, BoxCox.lambda(plastics)))
BoxCox.lambda(plastics)
forecast1 <- fit2.final$mean + fit2$time.series[,1][1:12]
lines(forecast1, col=4)
fit2 <- stl(plastics, s.window = "periodic", robust = TRUE)
eeadj <- seasadj(fit2)
plot(eeadj)
fit2.final <- rwf(eeadj, h=12, drift=TRUE)
plot(fit2.final)
plot(plastics, xlim=c(1,7))
forecast1 <- fit2.final$mean + fit2$time.series[,1][1:12]
lines(forecast1, col=4)
fit2 <- stl(plastics, s.window = "periodic", robust = TRUE)
eeadj <- seasadj(fit2)
plot(eeadj)
fit2.final <- rwf(eeadj, h=12, drift=TRUE)
plot(fit2.final)
plot(plastics, xlim=c(1,7))
forecast1 <- fit2.final$mean + fit2$time.series[,1][1:12]
lines(forecast1, col=4)
lines(fit2.final$mean, col=5)
plot(fit2)
plot(fit)
fit$seasonal
fit2$time.series[,1]
fit <- stl(elecequip, t.window=15, s.window="periodic", robust=TRUE)
fit$time.series[,1]
fit <- stl(elecequip, s.window=5)
fit$time.series[,1]
rm(list=ls())
plot(plastics, xlim=c(1,7))
fit <- decompose(plastics, type = "multiplicative")
s <- seasadj(fit)
plot(s)
fit.final <- rwf(s, h=12, drift = TRUE)
plot(fit.final)
plot(plastics, xlim=c(1,7))
forecast0 <- fit.final$mean * fit$seasonal[1:12]
x <- fit.final$mean * fit$seasonal[1:12]
lines(forecast0, col=4)
lines(forecast(forecast0), col=5)
lines(forecast(forecast0, methods="naive"), col=5)
lines(forecast(forecast0, method="naive"), col=5)
plot(forecast(forecast0, method="naive"), col=5)
plot(plastics, xlim=c(1,7))
forecast0 <- fit.final$mean * fit$seasonal[1:12]
x <- fit.final$mean * fit$seasonal[1:12]
lines(forecast0, col=4)
plot(forecast(forecast0, method="naive"), col=5)
plot(plastics, xlim=c(1,7))
forecast0 <- fit.final$mean * fit$seasonal[1:12]
x <- fit.final$mean * fit$seasonal[1:12]
lines(forecast0, col=4)
plot(forecast(forecast0, method="naive"), col=5)
plot(plastics, xlim=c(1,7))
forecast0 <- fit.final$mean * fit$seasonal[1:12]
x <- fit.final$mean * fit$seasonal[1:12]
lines(forecast0, col=4)
?stl
?seasadj
rm(list=ls())
fit <- decompose(plastics, type = "multiplicative")
s <- seasadj(fit)
plot(rwf(s, h=12, drift = TRUE),
main="Random Walk Drift forecast of seaonally adjusted data")
fcast <- forecast(fit, method="naive")
fit <- decompose(plastics, type = "multiplicative")
fcast <- forecast(fit, method="naive")
fit$seasonal
fit
snaive(fit$seasonal)
fit$seasonal
s
fit <- stl(elecequip, t.window=15, s.window="periodic", robust=TRUE)
eeadj <- seasadj(fit)
plot(naive(eeadj), xlab="New orders index",
main="Naive forecasts of seasonally adjusted data")
naive(eeadj)
forecast(eeadj, type="naive")
forecast(eeadj, method="naive")
fcast <- forecast(fit, method="naive")
plot(fcast, ylab="New orders index")
?forecast
fit.final <- rwf(s, h=12, drift = TRUE)
rm(list=ls())
fit <- decompose(plastics, type = "multiplicative")
s <- seasadj(fit)
fit.final <- rwf(s, h=12, drift = TRUE)
plot(rwf(s, h=12, drift = TRUE),
main="Random Walk Drift forecast of seaonally adjusted data")
plot(plastics, xlim=c(1,7))
forecast0 <- fit.final$mean * fit$seasonal[1:12]
x <- fit.final$mean * fit$seasonal[1:12]
lines(forecast0, col=4)
fit$seasonal[1:12]
snaive(fit$seasonal[1:12])
forecast(fit.final, method="naive")
plot(forecast(fit, method="naive"), xlim=c(1,7))
plot(forecast(fit, method="snaive"), xlim=c(1,7))
plot(forecast(fit.final, method="snaive"), xlim=c(1,7))
plot(forecast(fit.final, method="naive"), xlim=c(1,7))
plot(forecast(fit, method="naive"), xlim=c(1,7))
fit.final$mean * rwf(fit$seasonal[1:12])
rwf(fit$seasonal[1:12])
plot(plastics, xlim=c(1,7))
lines(rwf(fit$seasonal[1:20]))
plot(rwf(fit$seasonal[1:20]))
plot(rwf(fit$seasonal[1:20])*fit.final$mean)
fit.final$mean
fit$seasonal[1:12]
rwf(fit$seasonal)
rwf(fit$seasonal, h=12)
?rwf
rwf(fit$seasonal[1:12], h=12) # seasonal naive forecasts of seasonal component
rwf(fit$seasonal, h=12) # seasonal naive forecasts of seasonal component
sn <- rwf(fit$seasonal, h=12) # seasonal naive forecasts of seasonal component
fit.final
fit.final*sn
fit.final+sn
fit.final$mean
fit.final
fit.final <- rwf(s, h=12, drift = TRUE)
fit$seasonal
seasadj(fit)
fit$seasonal[1]*seasadj(fit)[1]
plastics[1]
sn
sn$mean
middle <- fit.final$mean * sn$mean
middle
sn$lower
sn$lower[1,]
sn$lower[,1]
plot(plastics, xlim=c(1,7))
sn <- rwf(fit$seasonal, h=12) # seasonal naive forecasts of seasonal component
middle <- fit.final$mean * sn$mean
lines(middle, col=4)
middle <- fit.final$mean * sn$mean
lines(middle, col=4)
sn$mean
fit.final$mean
fit.final$mean * sn$mean
?snaive
snaive(fit$seasonal, h=12)
?rwf
plot(plastics, xlim=c(1,7))
sn <- snaive(fit$seasonal, h=12) # seasonal naive forecasts of seasonal component
middle <- fit.final$mean * sn$mean
lines(middle, col=4)
lower80 <- fit.final$mean * sn$lower[,1] #80% lower
lower95 <- fit.final$mean * sn$lower[,2] #95% lower
upper80 <- fit.final$mean * sn$upper[,1] #80% upper
upper95 <- fit.final$mean * sn$upper[,2] #95% upper
plot(plastics, xlim=c(1,7))
sn <- snaive(fit$seasonal, h=12) # seasonal naive forecasts of seasonal component
middle <- fit.final$mean * sn$mean
plot(forecast(forecast0, method="naive"), col=15)
lines(middle, col=4)
lines(middle, col=14)
lines(middle, col=59)
lines(middle, col=509)
lines(middle, col=59)
lines(middle, col=66)
lines(middle, col=59)
lines(lower80, col=3)
lines(lower95, col=3)
middle
lower80
lower95
upper80
upper95
fit.final
middle
sn$mean
fit.final$lower
fit.final$lower[,1]
lower80 <- fit.final$lower[,1] * sn$mean #80% lower
lower95 <- fit.final$lower[,2] * sn$mean #95% lower
upper80 <- fit.final$upper[,1] * sn$mean #80% upper
upper95 <- fit.final$upper[,2] * sn$mean #95% upper
lines(middle, col=59)
lines(lower95, col=3)
lines(lower95, col=4)
lines(lower80, col=4)
lines(lower95, col=5)
lines(lower95, col=7)
lines(lower80, col=5)
lines(lower95, col=7)
lines(upper80, col=7)
lines(upper95, col=5)
lines(upper80, col=5)
lines(upper95, col=7)
fit2 <- stl(plastics, s.window = "periodic", robust = TRUE)
eeadj <- seasadj(fit2)
plot(eeadj)
fit2.final <- rwf(eeadj, h=12, drift=TRUE)
plot(fit2.final)
plot(plastics, xlim=c(1,7))
forecast1 <- fit2.final$mean + fit2$time.series[,1][1:12]
lines(forecast1, col=4)
lines(fit2.final$mean, col=5)
plot(plastics, xlim=c(1,7))
sn <- snaive(fit$seasonal, h=12) # seasonal naive forecasts of seasonal component
middle <- fit.final$mean * sn$mean
lower80 <- fit.final$lower[,1] * sn$mean #80% lower
lower95 <- fit.final$lower[,2] * sn$mean #95% lower
upper80 <- fit.final$upper[,1] * sn$mean #80% upper
upper95 <- fit.final$upper[,2] * sn$mean #95% upper
lines(middle, col=59)
lines(lower80, col=5)
lines(lower95, col=7)
lines(upper80, col=5)
lines(upper95, col=7)
plot(plastics, xlim=c(1,7), ylim=c(400, 2000))
sn <- snaive(fit$seasonal, h=12) # seasonal naive forecasts of seasonal component
middle <- fit.final$mean * sn$mean
lower80 <- fit.final$lower[,1] * sn$mean #80% lower
lower95 <- fit.final$lower[,2] * sn$mean #95% lower
upper80 <- fit.final$upper[,1] * sn$mean #80% upper
upper95 <- fit.final$upper[,2] * sn$mean #95% upper
lines(middle, col=59)
lines(lower80, col=5)
lines(lower95, col=7)
lines(upper80, col=5)
lines(upper95, col=7)
plot(plastics, xlim=c(1,7), ylim=c(400, 2000),
main="Prediction of monthly sales of plastics",
ylab="Sales", xlab="Year")
sn <- snaive(fit$seasonal, h=12) # seasonal naive forecasts of seasonal component
middle <- fit.final$mean * sn$mean
lower80 <- fit.final$lower[,1] * sn$mean #80% lower
lower95 <- fit.final$lower[,2] * sn$mean #95% lower
upper80 <- fit.final$upper[,1] * sn$mean #80% upper
upper95 <- fit.final$upper[,2] * sn$mean #95% upper
lines(middle, col=59)
lines(lower80, col=5)
lines(lower95, col=7)
lines(upper80, col=5)
lines(upper95, col=7)
lines(middle, col=59, lwd=2)
lines(middle, col=3, lwd=2)
lines(lower80, col=5)
lines(lower95, col=7)
lines(upper80, col=5)
lines(upper95, col=7)
snaive(fit$seasonal, h=12)
rwf(fit$seasonal, h=12)
plot(plastics, xlim=c(1,7), ylim=c(400, 2000),
main="Prediction of monthly sales of plastics",
ylab="Sales", xlab="Year")
sn <- snaive(fit$seasonal, h=12) # seasonal naive forecasts of seasonal component
middle <- fit.final$mean * sn$mean
lower80 <- fit.final$lower[,1] * sn$mean #80% lower
lower95 <- fit.final$lower[,2] * sn$mean #95% lower
upper80 <- fit.final$upper[,1] * sn$mean #80% upper
upper95 <- fit.final$upper[,2] * sn$mean #95% upper
lines(middle, col=3, lwd=2)
lines(lower80, col=5)
lines(lower95, col=7)
lines(upper80, col=5) #
lines(upper95, col=7) #yellow
?col
?color
??color
plot(plastics, xlim=c(1,7), ylim=c(400, 1800),
main="Prediction of monthly sales of plastics",
ylab="Sales", xlab="Year")
sn <- snaive(fit$seasonal, h=12) # seasonal naive forecasts of seasonal component
middle <- fit.final$mean * sn$mean
lower80 <- fit.final$lower[,1] * sn$mean #80% lower
lower95 <- fit.final$lower[,2] * sn$mean #95% lower
upper80 <- fit.final$upper[,1] * sn$mean #80% upper
upper95 <- fit.final$upper[,2] * sn$mean #95% upper
lines(middle, col=3, lwd=2)
lines(lower80, col=5) #blue
lines(lower95, col=7) #yellow
lines(upper80, col=5) #blue
lines(upper95, col=7) #yellow
# how do I plot shaded prediction interval?
plot(plastics, xlim=c(1,7), ylim=c(600, 2000),
main="Prediction of monthly sales of plastics",
ylab="Sales", xlab="Year")
sn <- snaive(fit$seasonal, h=12) # seasonal naive forecasts of seasonal component
middle <- fit.final$mean * sn$mean
lower80 <- fit.final$lower[,1] * sn$mean #80% lower
lower95 <- fit.final$lower[,2] * sn$mean #95% lower
upper80 <- fit.final$upper[,1] * sn$mean #80% upper
upper95 <- fit.final$upper[,2] * sn$mean #95% upper
lines(middle, col=3, lwd=2)
lines(lower80, col=5) #blue
lines(lower95, col=7) #yellow
lines(upper80, col=5) #blue
lines(upper95, col=7) #yellow
fit2 <- stl(plastics, s.window = "periodic", robust = TRUE)
eeadj <- seasadj(fit2)
plot(eeadj)
fit2.final <- rwf(eeadj, h=12, drift=TRUE)
plot(fit2.final)
plot(plastics, xlim=c(1,7))
forecast1 <- fit2.final$mean + fit2$time.series[,1][1:12]
lines(forecast1, col=4)
fit2 <- stl(plastics, s.window = "periodic", robust = TRUE)
plot(forecast(fit2, method="naive"))
plot(forecast(fit2, method="naive"), xlim=c(1,7))
plot(forecast(fit2, method="naive"))
plot(forecast(fit2, method="naive"), ylab="Sales", xlab="Year")
lines(fit2.final$mean, col=5)
fit.final <- rwf(s, h=12, drift = TRUE)
plot(rwf(s, h=12, drift = TRUE),
main="Random Walk Drift forecast of seaonally adjusted data")
plot(plastics, xlim=c(1,7), ylim=c(600, 2000),
main="Prediction of monthly sales of plastics",
ylab="Sales", xlab="Year")
sn <- snaive(fit$seasonal, h=12) # seasonal naive forecasts of seasonal component
middle <- fit.final$mean * sn$mean
lower80 <- fit.final$lower[,1] * sn$mean #80% lower
lower95 <- fit.final$lower[,2] * sn$mean #95% lower
upper80 <- fit.final$upper[,1] * sn$mean #80% upper
upper95 <- fit.final$upper[,2] * sn$mean #95% upper
lines(middle, col=3, lwd=2)
lines(lower80, col=5) #blue
lines(lower95, col=7) #yellow
lines(upper80, col=5) #blue
lines(upper95, col=7) #yellow
legend("topleft", lty=c(1,2,1), col=c(5, 3, 7),
legend=c("80% Lower/Upper", "Mean", "95% Lower/Upper"))
legend("topleft", lwd=c(1,2,1), col=c(5, 3, 7),
legend=c("80% Lower/Upper", "Mean", "95% Lower/Upper"))
legend("topleft", lwd=c(1,2,1), col=c(5, 3, 7),
legend=c("80% Lower/Upper", "Mean", "95% Lower/Upper"),
cex=0.5, xjust=1, yjust=1)
plot(plastics, xlim=c(1,7), ylim=c(600, 2000),
main="Prediction of monthly sales of plastics",
ylab="Sales", xlab="Year")
sn <- snaive(fit$seasonal, h=12) # seasonal naive forecasts of seasonal component
middle <- fit.final$mean * sn$mean
lower80 <- fit.final$lower[,1] * sn$mean #80% lower
lower95 <- fit.final$lower[,2] * sn$mean #95% lower
upper80 <- fit.final$upper[,1] * sn$mean #80% upper
upper95 <- fit.final$upper[,2] * sn$mean #95% upper
lines(middle, col=3, lwd=2)
lines(lower80, col=5) #blue
lines(lower95, col=7) #yellow
lines(upper80, col=5) #blue
lines(upper95, col=7) #yellow
legend("topleft", lwd=c(1,2,1), col=c(5, 3, 7),
legend=c("80% Lower/Upper", "Mean", "95% Lower/Upper"),
cex=0.5, xjust=1, yjust=1)
q()
